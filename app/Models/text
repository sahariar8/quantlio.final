Using Array of Drug Names (Converted from Prescribed Medication List to be Drug Names)

Check for Metabolites List of any Prescribed Drugs, if Metabolites (as well as Metabolites of Metabolites) exist, 
they should be included in expected tests that would satisfy each prescribed medication. 
These metabolites should only be part of the list if they are ordered tests.

IF Test Result (OR Metabolite) is DETECTED and Prescription List Presence is TRUE, THEN the flag is PRESCRIBED DETECTED (compliant)

IF Test Result (OR Metabolite) is DETECTED and Prescription List Presence is FALSE, THEN the flag is NOT PRESCRIBED DETECTED (non-compliant np)

IF Test Result (AND Metabolite) is NOT DETECTED and Prescription List Presence is TRUE, THEN the flag is PRESCRIBED NOT DETECTED (non-compliant)

IF Test Result (AND Metabolite) is NOT DETECTED and Prescription List Presence is FALSE, THEN the flag is NOT PRESCRIBED NOT DETECTED (compliant - listed as blank in Stratus)

Please let me know if you need anything additional to describe these scenarios more clearly.